{% extends 'base.html' %}

{% block content %}

<script src="/static/scripts/jquery/jquery.min.js"></script>
    <script>
        $(function() {
        $('input').click(function() {
            $.ajax({
                url: '/follow/{{user_data.email}}',
                success: function(data) {
                    document.getElementById('follow-disp').innerHTML=data["count"]+" Followers"
                    document.getElementById('follow-bar').disabled=true;
                    document.getElementById("follow-bar").innerHTML="Following"
                },
                error: function(error) {
                    alert("error");
                    console.log(error);
                }
            });
        });
        });
</script>


<div class="container-fluid" style="margin-top: 20px;">

    <div class="row">
        <div class="col-sm-1">
            <form action="{{ url_for('index') }}">
                <button class="image-share"><img src="/static/img/go-back.png"></button>
            </form>
        </div>

    <div class="col-sm-2" style="padding-left: 100px;">
    <center>
    <div class="card shadow" style="width: 1000px;border:6px;border-radius: 25px;padding-top:0px;padding: 20px;">
        <div class="row no-gutters">
            <div class="col-sm-5">
                <img class="card-img" src="/static/portal_images/{{img_data.id}}.jpg" alt="{{img_data.title}}">
            </div>
            <div class="col-sm-7">
                <div class="card-body">

                    <div class="card-body" style="background-color: white">
                        <div class="row">
                            <div class="col-sm">
                                <form action="{{ url_for('view_photo',photo_id=img_data.id) }}" method="POST">
                                    <button class="image-share"><img width="50%" src="/static/img/3dots.png"></button>
                                </form>
                            </div>
                            <div class="col-sm" style="padding-right: 200px;">
                                <button class="image-share" onclick="window.open(
                                    'https://twitter.com/intent/tweet?text=Check out the pin at Pinterest on {{img_data.title}} at &url=+{{request.url}}', 
                                    'twitter-share-dialog', 
                                    'width=626,height=436'); 
                                    return false;"><img width="80%" src="/static/img/upload-icon.png"></button>
                            </div>
                            <div class="col-sm">
                                <form action="{{ url_for('save_pins',img_id=img_data.id) }}" method="GET">
                                <button class="image-save"  {% if not flag_save_check %} disabled {% endif %}>
                                    {% if flag_save_check %}    Save  {% else %}  Saved  {% endif %}
                                </button>
                                </form>
                            </div>
                        </div>
                    </div>



                    <a href="{{img_data.links}}">{{img_data.links}}</a>
                    <br><br>
                    <h1 class="card-title" style="font-weight: 750;">{{img_data.title}}</h1>
                    <p class="card-text">{{img_data.description}}</p>
                    
                    <hr><br>

                    <div class="row">
                        <div class="col">
                            <div class="row">
                                <div class="col">
                                    <img src="/static/portal_images/user{{user_data.id}}.jpg"	class="rounded-circle" width="100" height="100">
                                </div>
                                <div class="col">
                                    <p style="font-size:medium;font-weight: 500;">{{ user_data.name }}</p>
                                    <p id="follow-disp">{{follow_count}} Followers</p>
                                    <form action="{{url_for('profile_view',profile_email=user_data.email,action=1) }}" method="GET">
                                        <button class="btn btn-primary">Visit Profile</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <form method="POST" action="{{ url_for('user_follow_action',email=user_data.email) }}">
                                <button id="follow-bar" style="padding: 15px 20px;
                                background-color: lightgrey;
                                border-radius: 20px;
                                font-weight: 600;
                                border:0;font-weight: 600;" {% if not flag_follow_check %} disabled {% endif %}> 
                                    {% if not flag_follow_check %} Followed {% else %} Follow {% endif %}
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </center>
    </div>
    </div>

    <center><p style="padding-top: 50px;font-weight: 750;font-size: x-large;">More like this</p></center>
</div>

<div class="container-fluid mb-5">
	<div class="row">
		<div class="card-columns">

			{% for image in images_list %}
			<div class="card card-pin">
				<div class="image-container">
					<img class="card-img image" src="/static/portal_images/{{image.id}}.jpg" alt="{{image.title}}" >
				</div>

				<div class="card-body">
					<a class="card-link" href="{{ url_for('view_photo',photo_id=image.id) }}"><h5 class="card-title title">{{ image.title }}</h5></a>
				</div>
			</div>
			{% endfor %}
		</div>
	</div>
</div>

{% endblock %}